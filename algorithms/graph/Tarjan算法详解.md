# Tarjanç®—æ³•è¯¦è§£ - å¼ºè¿é€šåˆ†é‡æ±‚è§£çš„ç»å…¸ç®—æ³•

## ğŸ“š ç®—æ³•èƒŒæ™¯

**Tarjanç®—æ³•**ç”±ç¾å›½è®¡ç®—æœºç§‘å­¦å®¶Robert Tarjanäº1972å¹´æå‡ºï¼Œæ˜¯æ±‚è§£æœ‰å‘å›¾å¼ºè¿é€šåˆ†é‡çš„ç»å…¸ç®—æ³•ä¹‹ä¸€ã€‚è¯¥ç®—æ³•åŸºäºæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)ï¼Œå…·æœ‰çº¿æ€§æ—¶é—´å¤æ‚åº¦O(V+E)ï¼Œæ˜¯ç›®å‰æœ€é«˜æ•ˆçš„å¼ºè¿é€šåˆ†é‡æ±‚è§£ç®—æ³•ä¹‹ä¸€ã€‚

### ğŸ¯ æ ¸å¿ƒæ¦‚å¿µ

#### å¼ºè¿é€šåˆ†é‡ (Strongly Connected Component, SCC)
åœ¨æœ‰å‘å›¾Gä¸­ï¼Œå¦‚æœä»é¡¶ç‚¹vèƒ½å¤Ÿåˆ°è¾¾é¡¶ç‚¹uï¼ŒåŒæ—¶ä»é¡¶ç‚¹uä¹Ÿèƒ½å¤Ÿåˆ°è¾¾é¡¶ç‚¹vï¼Œåˆ™ç§°vå’Œu**å¼ºè¿é€š**ã€‚åœ¨æœ‰å‘å›¾ä¸­ï¼Œ**å¼ºè¿é€šåˆ†é‡**æ˜¯ä¸€ä¸ªæœ€å¤§çš„é¡¶ç‚¹é›†åˆï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹éƒ½æ˜¯å¼ºè¿é€šçš„ã€‚

#### æ—¶é—´æˆ³ä¸è¿½æº¯å€¼
- **æ—¶é—´æˆ³ dfn[u]**ï¼šèŠ‚ç‚¹uåœ¨DFSä¸­è¢«é¦–æ¬¡è®¿é—®çš„æ—¶é—´
- **è¿½æº¯å€¼ low[u]**ï¼šä»èŠ‚ç‚¹uå‡ºå‘ï¼Œé€šè¿‡DFSèƒ½å¤Ÿåˆ°è¾¾çš„æ‰€æœ‰èŠ‚ç‚¹ä¸­ï¼Œæ—¶é—´æˆ³çš„æœ€å°å€¼

## ğŸ§  ç®—æ³•åŸç†

### æ ¸å¿ƒæ€æƒ³

Tarjanç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š**å½“ä¸”ä»…å½“ dfn[u] = low[u] æ—¶ï¼ŒèŠ‚ç‚¹uæ˜¯æŸä¸ªå¼ºè¿é€šåˆ†é‡çš„æ ¹èŠ‚ç‚¹**ã€‚

### ç®—æ³•æµç¨‹

1. **DFSéå†**ï¼šæŒ‰DFSé¡ºåºè®¿é—®å›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹
2. **æ—¶é—´æˆ³è®°å½•**ï¼šè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„è®¿é—®æ—¶é—´ dfn[u]
3. **è¿½æº¯å€¼æ›´æ–°**ï¼šè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„è¿½æº¯å€¼ low[u]
4. **æ ˆç»´æŠ¤**ï¼šä½¿ç”¨æ ˆç»´æŠ¤å½“å‰è·¯å¾„ä¸Šçš„èŠ‚ç‚¹
5. **SCCè¯†åˆ«**ï¼šå½“ dfn[u] = low[u] æ—¶ï¼Œè¯†åˆ«å‡ºä¸€ä¸ªå¼ºè¿é€šåˆ†é‡

### è¿½æº¯å€¼æ›´æ–°è§„åˆ™

å¯¹äºèŠ‚ç‚¹uçš„æ¯ä¸ªé‚»æ¥èŠ‚ç‚¹vï¼š

```
if væœªè¢«è®¿é—®:
    é€’å½’è®¿é—®v
    low[u] = min(low[u], low[v])
else if våœ¨æ ˆä¸­:
    low[u] = min(low[u], dfn[v])
```

## ğŸ“Š ç®—æ³•å¯è§†åŒ–æ¼”ç¤º

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå…·ä½“ä¾‹å­æ¥ç†è§£Tarjanç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼š

### ç¤ºä¾‹å›¾

```mermaid
graph TD
    A["1"] --> B["2"]
    B --> C["3"]
    C --> A
    B --> D["4"]
    D --> E["5"]
    E --> D
    C --> F["6"]
```

### æ‰§è¡Œè¿‡ç¨‹

| æ­¥éª¤ | è®¿é—®èŠ‚ç‚¹ | dfn | low | æ ˆçŠ¶æ€ | æ“ä½œ |
|------|----------|-----|-----|--------|------|
| 1 | 1 | 1 | 1 | [1] | è®¿é—®èŠ‚ç‚¹1 |
| 2 | 2 | 2 | 2 | [1,2] | è®¿é—®èŠ‚ç‚¹2 |
| 3 | 3 | 3 | 3 | [1,2,3] | è®¿é—®èŠ‚ç‚¹3 |
| 4 | - | - | - | [1,2,3] | 3â†’1ï¼Œ1åœ¨æ ˆä¸­ï¼Œlow[3]=min(3,1)=1 |
| 5 | - | - | - | [1,2,3] | å›æº¯åˆ°3ï¼Œlow[2]=min(2,1)=1 |
| 6 | 4 | 4 | 4 | [1,2,3,4] | è®¿é—®èŠ‚ç‚¹4 |
| 7 | 5 | 5 | 5 | [1,2,3,4,5] | è®¿é—®èŠ‚ç‚¹5 |
| 8 | - | - | - | [1,2,3,4,5] | 5â†’4ï¼Œ4åœ¨æ ˆä¸­ï¼Œlow[5]=min(5,4)=4 |
| 9 | - | - | - | [1,2,3,4] | dfn[5]=low[5]â‰ 4ï¼Œå›æº¯ï¼Œå¼¹å‡º5ï¼ŒSCC:{5} |
| 10 | - | - | - | [1,2,3] | dfn[4]=low[4]=4ï¼Œå¼¹å‡º4ï¼ŒSCC:{4,5} |
| 11 | 6 | 6 | 6 | [1,2,3,6] | è®¿é—®èŠ‚ç‚¹6 |
| 12 | - | - | - | [1,2,3] | dfn[6]=low[6]=6ï¼Œå¼¹å‡º6ï¼ŒSCC:{6} |
| 13 | - | - | - | [] | dfn[3]=low[3]=1ï¼Œå¼¹å‡º1,2,3ï¼ŒSCC:{1,2,3} |

## ğŸ’» å®Œæ•´ä»£ç å®ç°

### C++æ¨¡æ¿ä»£ç 

```cpp
#include <iostream>
#include <vector>
#include <stack>
#include <algorithm>
using namespace std;

class TarjanSCC {
private:
    int n;                          // èŠ‚ç‚¹æ•°
    vector<vector<int>> graph;      // é‚»æ¥è¡¨
    vector<int> dfn, low;          // æ—¶é—´æˆ³å’Œè¿½æº¯å€¼
    vector<bool> inStack;          // æ˜¯å¦åœ¨æ ˆä¸­
    stack<int> st;                 // DFSæ ˆ
    vector<vector<int>> sccs;      // å­˜å‚¨æ‰€æœ‰å¼ºè¿é€šåˆ†é‡
    int timestamp;                 // æ—¶é—´æˆ³è®¡æ•°å™¨
    
    void tarjan(int u) {
        // åˆå§‹åŒ–å½“å‰èŠ‚ç‚¹
        dfn[u] = low[u] = ++timestamp;
        st.push(u);
        inStack[u] = true;
        
        // éå†æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹
        for (int v : graph[u]) {
            if (dfn[v] == 0) {
                // væœªè¢«è®¿é—®ï¼Œé€’å½’è®¿é—®
                tarjan(v);
                low[u] = min(low[u], low[v]);
            } else if (inStack[v]) {
                // våœ¨æ ˆä¸­ï¼Œè¯´æ˜å­˜åœ¨å›è¾¹
                low[u] = min(low[u], dfn[v]);
            }
        }
        
        // å¦‚æœuæ˜¯å¼ºè¿é€šåˆ†é‡çš„æ ¹èŠ‚ç‚¹
        if (dfn[u] == low[u]) {
            vector<int> scc;
            int v;
            do {
                v = st.top();
                st.pop();
                inStack[v] = false;
                scc.push_back(v);
            } while (v != u);
            
            sccs.push_back(scc);
        }
    }
    
public:
    TarjanSCC(int n) : n(n), graph(n + 1), dfn(n + 1, 0), 
                       low(n + 1, 0), inStack(n + 1, false), timestamp(0) {}
    
    void addEdge(int u, int v) {
        graph[u].push_back(v);
    }
    
    void findSCC() {
        for (int i = 1; i <= n; i++) {
            if (dfn[i] == 0) {
                tarjan(i);
            }
        }
    }
    
    void printSCCs() {
        cout << "å¼ºè¿é€šåˆ†é‡æ•°é‡: " << sccs.size() << endl;
        for (int i = 0; i < sccs.size(); i++) {
            cout << "SCC " << i + 1 << ": ";
            for (int v : sccs[i]) {
                cout << v << " ";
            }
            cout << endl;
        }
    }
    
    vector<vector<int>> getSCCs() {
        return sccs;
    }
};

// ä½¿ç”¨ç¤ºä¾‹
int main() {
    int n = 6; // èŠ‚ç‚¹æ•°
    TarjanSCC tarjan(n);
    
    // æ·»åŠ è¾¹
    tarjan.addEdge(1, 2);
    tarjan.addEdge(2, 3);
    tarjan.addEdge(3, 1);
    tarjan.addEdge(2, 4);
    tarjan.addEdge(4, 5);
    tarjan.addEdge(5, 4);
    tarjan.addEdge(3, 6);
    
    // æ±‚è§£å¼ºè¿é€šåˆ†é‡
    tarjan.findSCC();
    
    // è¾“å‡ºç»“æœ
    tarjan.printSCCs();
    
    return 0;
}
```

### ç®€åŒ–ç‰ˆæ¨¡æ¿

```cpp
const int MAXN = 100005;
vector<int> graph[MAXN];
int dfn[MAXN], low[MAXN], timestamp_cnt;
bool inStack[MAXN];
stack<int> st;
vector<vector<int>> sccs;

void tarjan(int u) {
    dfn[u] = low[u] = ++timestamp_cnt;
    st.push(u);
    inStack[u] = true;
    
    for (int v : graph[u]) {
        if (!dfn[v]) {
            tarjan(v);
            low[u] = min(low[u], low[v]);
        } else if (inStack[v]) {
            low[u] = min(low[u], dfn[v]);
        }
    }
    
    if (dfn[u] == low[u]) {
        vector<int> scc;
        int v;
        do {
            v = st.top();
            st.pop();
            inStack[v] = false;
            scc.push_back(v);
        } while (v != u);
        sccs.push_back(scc);
    }
}
```

## ğŸ¯ ç»å…¸åº”ç”¨åœºæ™¯

### 1. å¼ºè¿é€šåˆ†é‡æ±‚è§£
- **é—®é¢˜**ï¼šæ±‚æœ‰å‘å›¾ä¸­æ‰€æœ‰å¼ºè¿é€šåˆ†é‡
- **åº”ç”¨**ï¼šç½‘ç»œåˆ†æã€ç¤¾äº¤ç½‘ç»œåˆ†ç¾¤ç­‰

### 2. å·®åˆ†çº¦æŸç³»ç»Ÿ
- **é—®é¢˜**ï¼šæ±‚è§£ä¸€ç»„å·®åˆ†ä¸ç­‰å¼çš„å¯è¡Œè§£
- **æ–¹æ³•**ï¼šå»ºå›¾åç”¨Tarjanæ£€æµ‹æ­£ç¯
- **ä¾‹é¢˜**ï¼šæ´›è°·P3275 ç³–æœåˆ†é…é—®é¢˜

### 3. 2-SATé—®é¢˜
- **é—®é¢˜**ï¼šåˆ¤æ–­å¸ƒå°”è¡¨è¾¾å¼çš„å¯æ»¡è¶³æ€§
- **æ–¹æ³•**ï¼šå»ºç«‹è•´å«å›¾åæ±‚å¼ºè¿é€šåˆ†é‡
- **åº”ç”¨**ï¼šé€»è¾‘ç”µè·¯è®¾è®¡ã€çº¦æŸæ»¡è¶³é—®é¢˜

### 4. ç¼©ç‚¹æ„å»ºDAG
- **é—®é¢˜**ï¼šå°†å¼ºè¿é€šåˆ†é‡ç¼©ä¸ºå•ç‚¹æ„å»ºDAG
- **åº”ç”¨**ï¼šæ‹“æ‰‘æ’åºã€æœ€é•¿è·¯å¾„é—®é¢˜

## ğŸ“ ç»å…¸ä¾‹é¢˜è¯¦è§£

### ä¾‹é¢˜1ï¼šæ´›è°·P2863 - ç‰›çš„èˆä¼š

**é¢˜ç›®æè¿°**ï¼šç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ±‚å…¶ä¸­åŒ…å«èŠ‚ç‚¹æ•°å¤§äº1çš„å¼ºè¿é€šåˆ†é‡çš„ä¸ªæ•°ã€‚

**è§£é¢˜æ€è·¯**ï¼š
1. ä½¿ç”¨Tarjanç®—æ³•æ±‚å‡ºæ‰€æœ‰å¼ºè¿é€šåˆ†é‡
2. ç»Ÿè®¡å¤§å°å¤§äº1çš„å¼ºè¿é€šåˆ†é‡ä¸ªæ•°

**ä»£ç å®ç°**ï¼š
```cpp
#include <iostream>
#include <vector>
#include <stack>
using namespace std;

// Tarjanç®—æ³•æ±‚å¼ºè¿é€šåˆ†é‡
void solve() {
    int n, m;
    cin >> n >> m;
    
    TarjanSCC tarjan(n);
    for (int i = 0; i < m; i++) {
        int u, v;
        cin >> u >> v;
        tarjan.addEdge(u, v);
    }
    
    tarjan.findSCC();
    vector<vector<int>> sccs = tarjan.getSCCs();
    
    int count = 0;
    for (auto& scc : sccs) {
        if (scc.size() > 1) {
            count++;
        }
    }
    
    cout << count << endl;
}
```

### ä¾‹é¢˜2ï¼šå¼ºè¿é€šåˆ†é‡ç¼©ç‚¹

**é¢˜ç›®æè¿°**ï¼šç»™å®šæœ‰å‘å›¾ï¼Œæ±‚ç¼©ç‚¹åDAGä¸­çš„èŠ‚ç‚¹æ•°ã€‚

**è§£é¢˜æ€è·¯**ï¼š
1. æ±‚å‡ºæ‰€æœ‰å¼ºè¿é€šåˆ†é‡
2. æ¯ä¸ªå¼ºè¿é€šåˆ†é‡å¯¹åº”ç¼©ç‚¹åDAGä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹

```cpp
void buildDAG() {
    // å‡è®¾å·²ç»æ±‚å‡ºå¼ºè¿é€šåˆ†é‡å¹¶å­˜å‚¨åœ¨sccsä¸­
    int scc_count = sccs.size();
    vector<int> scc_id(n + 1); // è®°å½•æ¯ä¸ªèŠ‚ç‚¹å±äºå“ªä¸ªå¼ºè¿é€šåˆ†é‡
    
    // ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…å¼ºè¿é€šåˆ†é‡ç¼–å·
    for (int i = 0; i < scc_count; i++) {
        for (int v : sccs[i]) {
            scc_id[v] = i;
        }
    }
    
    // æ„å»ºæ–°å›¾
    vector<set<int>> new_graph(scc_count);
    for (int u = 1; u <= n; u++) {
        for (int v : graph[u]) {
            if (scc_id[u] != scc_id[v]) {
                new_graph[scc_id[u]].insert(scc_id[v]);
            }
        }
    }
    
    cout << "DAGèŠ‚ç‚¹æ•°: " << scc_count << endl;
}
```

## âš¡ æ€§èƒ½åˆ†æä¸ä¼˜åŒ–

### æ—¶é—´å¤æ‚åº¦
- **DFSéå†**ï¼šO(V+E) - æ¯ä¸ªèŠ‚ç‚¹å’Œè¾¹éƒ½è¢«è®¿é—®ä¸€æ¬¡
- **æ ˆæ“ä½œ**ï¼šO(V) - æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå…¥æ ˆå‡ºæ ˆä¸€æ¬¡
- **æ€»å¤æ‚åº¦**ï¼š**O(V+E)**

### ç©ºé—´å¤æ‚åº¦
- **æ•°ç»„å­˜å‚¨**ï¼šO(V) - dfn, low, inStackæ•°ç»„
- **æ ˆç©ºé—´**ï¼šO(V) - æœ€åæƒ…å†µä¸‹æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨æ ˆä¸­
- **é€’å½’æ·±åº¦**ï¼šO(V) - DFSé€’å½’æ ˆæ·±åº¦
- **æ€»å¤æ‚åº¦**ï¼š**O(V)**

### å¸¸è§ä¼˜åŒ–æŠ€å·§

#### 1. é¿å…æ ˆæº¢å‡º
```cpp
// å¯¹äºè¶…å¤§å›¾ï¼Œå¯ä»¥ä½¿ç”¨æ˜¾å¼æ ˆé¿å…é€’å½’æ ˆæº¢å‡º
void iterativeTarjan(int start) {
    stack<pair<int, int>> dfs_stack; // (èŠ‚ç‚¹, çŠ¶æ€)
    dfs_stack.push({start, 0});
    
    while (!dfs_stack.empty()) {
        auto [u, state] = dfs_stack.top();
        dfs_stack.pop();
        
        if (state == 0) {
            // é¦–æ¬¡è®¿é—®èŠ‚ç‚¹u
            if (dfn[u] != 0) continue;
            
            dfn[u] = low[u] = ++timestamp_cnt;
            st.push(u);
            inStack[u] = true;
            
            // å‹å…¥çŠ¶æ€1ï¼Œå‡†å¤‡å¤„ç†é‚»æ¥èŠ‚ç‚¹
            dfs_stack.push({u, 1});
            
            // å‹å…¥æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹
            for (int v : graph[u]) {
                dfs_stack.push({v, 0});
            }
        } else {
            // å¤„ç†å®Œæ‰€æœ‰é‚»æ¥èŠ‚ç‚¹ï¼Œæ£€æŸ¥æ˜¯å¦ä¸ºSCCæ ¹
            // ... å¤„ç†é€»è¾‘
        }
    }
}
```

#### 2. å†…å­˜ä¼˜åŒ–
```cpp
// å¯¹äºç¨ å¯†å›¾ï¼Œå¯ä»¥ä½¿ç”¨é‚»æ¥çŸ©é˜µ
class TarjanMatrix {
private:
    vector<vector<bool>> adj;
    // ... å…¶ä»–æˆå‘˜å˜é‡
    
public:
    void addEdge(int u, int v) {
        adj[u][v] = true;
    }
    
    void tarjan(int u) {
        // ... åˆå§‹åŒ–
        
        for (int v = 1; v <= n; v++) {
            if (adj[u][v]) {
                // å¤„ç†è¾¹u->v
            }
        }
        
        // ... å…¶ä½™é€»è¾‘
    }
};
```

## ğŸš¨ å¸¸è§é”™è¯¯ä¸è°ƒè¯•æŠ€å·§

### å¸¸è§é”™è¯¯

#### 1. æ—¶é—´æˆ³åˆå§‹åŒ–é”™è¯¯
```cpp
// âŒ é”™è¯¯ï¼šæ—¶é—´æˆ³ä»0å¼€å§‹
int timestamp_cnt = 0;

// âœ… æ­£ç¡®ï¼šæ—¶é—´æˆ³ä»1å¼€å§‹ï¼Œ0è¡¨ç¤ºæœªè®¿é—®
int timestamp_cnt = 0;
dfn[u] = low[u] = ++timestamp_cnt; // å…ˆé€’å¢å†èµ‹å€¼
```

#### 2. æ ˆçŠ¶æ€ç®¡ç†é”™è¯¯
```cpp
// âŒ é”™è¯¯ï¼šå¿˜è®°æ ‡è®°inStack
st.push(u);
// inStack[u] = true; // å¿˜è®°è®¾ç½®

// âœ… æ­£ç¡®ï¼šå¿…é¡»åŒæ—¶è®¾ç½®æ ˆçŠ¶æ€
st.push(u);
inStack[u] = true;
```

#### 3. å›è¾¹åˆ¤æ–­é”™è¯¯
```cpp
// âŒ é”™è¯¯ï¼šæ‰€æœ‰å·²è®¿é—®èŠ‚ç‚¹éƒ½æ›´æ–°lowå€¼
if (dfn[v] != 0) {
    low[u] = min(low[u], dfn[v]); // é”™è¯¯
}

// âœ… æ­£ç¡®ï¼šåªæœ‰æ ˆä¸­èŠ‚ç‚¹æ‰æ›´æ–°lowå€¼
if (dfn[v] != 0 && inStack[v]) {
    low[u] = min(low[u], dfn[v]); // æ­£ç¡®
}
```

### è°ƒè¯•æŠ€å·§

#### 1. è¾“å‡ºä¸­é—´çŠ¶æ€
```cpp
void debugTarjan(int u) {
    cout << "Visit " << u << ": dfn=" << dfn[u] << ", low=" << low[u] << endl;
    
    // è¾“å‡ºå½“å‰æ ˆçŠ¶æ€
    stack<int> temp = st;
    cout << "Stack: ";
    while (!temp.empty()) {
        cout << temp.top() << " ";
        temp.pop();
    }
    cout << endl;
}
```

#### 2. éªŒè¯ç»“æœæ­£ç¡®æ€§
```cpp
void validateSCC(const vector<vector<int>>& sccs) {
    // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«åˆ†é…åˆ°æŸä¸ªå¼ºè¿é€šåˆ†é‡
    vector<bool> visited(n + 1, false);
    for (const auto& scc : sccs) {
        for (int v : scc) {
            if (visited[v]) {
                cout << "é”™è¯¯ï¼šèŠ‚ç‚¹" << v << "å‡ºç°åœ¨å¤šä¸ªå¼ºè¿é€šåˆ†é‡ä¸­" << endl;
            }
            visited[v] = true;
        }
    }
    
    for (int i = 1; i <= n; i++) {
        if (!visited[i]) {
            cout << "é”™è¯¯ï¼šèŠ‚ç‚¹" << i << "æœªè¢«åˆ†é…åˆ°ä»»ä½•å¼ºè¿é€šåˆ†é‡" << endl;
        }
    }
}
```

## ğŸ“š ç›¸å…³ç®—æ³•å¯¹æ¯”

### Tarjan vs Kosaraju

| ç‰¹å¾ | Tarjanç®—æ³• | Kosarajuç®—æ³• |
|------|------------|--------------|
| **æ—¶é—´å¤æ‚åº¦** | O(V+E) | O(V+E) |
| **ç©ºé—´å¤æ‚åº¦** | O(V) | O(V) |
| **DFSæ¬¡æ•°** | 1æ¬¡ | 2æ¬¡ |
| **å®ç°éš¾åº¦** | ä¸­ç­‰ | ç®€å• |
| **å¸¸æ•°å› å­** | è¾ƒå° | è¾ƒå¤§ |
| **é€‚ç”¨åœºæ™¯** | åœ¨çº¿ç®—æ³•ï¼Œå®æ—¶æ€§è¦æ±‚é«˜ | ç¦»çº¿ç®—æ³•ï¼Œæ˜“äºç†è§£ |

### Kosarajuç®—æ³•ç®€ä»‹

```cpp
void kosaraju() {
    // ç¬¬ä¸€æ¬¡DFSï¼Œè®°å½•å®Œæˆæ—¶é—´
    stack<int> finish_order;
    vector<bool> visited(n + 1, false);
    
    function<void(int)> dfs1 = [&](int u) {
        visited[u] = true;
        for (int v : graph[u]) {
            if (!visited[v]) {
                dfs1(v);
            }
        }
        finish_order.push(u);
    };
    
    for (int i = 1; i <= n; i++) {
        if (!visited[i]) {
            dfs1(i);
        }
    }
    
    // ç¬¬äºŒæ¬¡DFSï¼Œåœ¨è½¬ç½®å›¾ä¸ŠæŒ‰å®Œæˆæ—¶é—´é€†åºè®¿é—®
    fill(visited.begin(), visited.end(), false);
    vector<vector<int>> sccs;
    
    function<void(int, vector<int>&)> dfs2 = [&](int u, vector<int>& scc) {
        visited[u] = true;
        scc.push_back(u);
        for (int v : reverse_graph[u]) {
            if (!visited[v]) {
                dfs2(v, scc);
            }
        }
    };
    
    while (!finish_order.empty()) {
        int u = finish_order.top();
        finish_order.pop();
        
        if (!visited[u]) {
            vector<int> scc;
            dfs2(u, scc);
            sccs.push_back(scc);
        }
    }
}
```

## ğŸ“ ç»ƒä¹ é¢˜æ¨è

### å…¥é—¨çº§
1. **æ´›è°·P2863** - ç‰›çš„èˆä¼š (å¼ºè¿é€šåˆ†é‡è®¡æ•°)
2. **POJ2186** - Popular Cows (å¼ºè¿é€šåˆ†é‡+æ‹“æ‰‘)
3. **HDU1269** - è¿·å®«åŸå ¡ (å¼ºè¿é€šå›¾åˆ¤æ–­)

### è¿›é˜¶çº§
1. **æ´›è°·P3275** - ç³–æœ (å·®åˆ†çº¦æŸ+Tarjan)
2. **æ´›è°·P2341** - å—æ¬¢è¿çš„ç‰› (å¼ºè¿é€šåˆ†é‡+ç»Ÿè®¡)
3. **SPOJ SUBLEX** - Lexicographical Substring Search

### æŒ‘æˆ˜çº§
1. **æ´›è°·P4819** - [ä¸­å±±å¸‚é€‰2007]æ€æ‰‹ (2-SAT)
2. **Codeforces 1394D** - Parallel Universes (åŠ¨æ€å¼ºè¿é€šåˆ†é‡)
3. **ICPC WF 2019** - Circular DNA (å¤æ‚å›¾è®ºå»ºæ¨¡)

## ğŸ† æ€»ç»“

Tarjanç®—æ³•æ˜¯å›¾è®ºä¸­çš„ç»å…¸ç®—æ³•ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### ä¼˜åŠ¿
- âœ… **çº¿æ€§æ—¶é—´å¤æ‚åº¦**ï¼šO(V+E)ï¼Œæ•ˆç‡æé«˜
- âœ… **ä¸€æ¬¡éå†**ï¼šåªéœ€ä¸€æ¬¡DFSå³å¯æ±‚å‡ºæ‰€æœ‰å¼ºè¿é€šåˆ†é‡
- âœ… **åº”ç”¨å¹¿æ³›**ï¼šå¼ºè¿é€šåˆ†é‡ã€2-SATã€å·®åˆ†çº¦æŸç­‰
- âœ… **å®ç°ä¼˜é›…**ï¼šä»£ç ç®€æ´ï¼Œé€»è¾‘æ¸…æ™°

### å…³é”®è¦ç‚¹
1. **ç†è§£æ ¸å¿ƒæ€æƒ³**ï¼šdfn[u] = low[u] æ˜¯SCCæ ¹çš„å……è¦æ¡ä»¶
2. **æŒæ¡çŠ¶æ€è½¬ç§»**ï¼šæ­£ç¡®æ›´æ–°lowå€¼æ˜¯ç®—æ³•å…³é”®
3. **æ³¨æ„å®ç°ç»†èŠ‚**ï¼šæ ˆçŠ¶æ€ç®¡ç†ã€æ—¶é—´æˆ³åˆå§‹åŒ–ç­‰
4. **çµæ´»åº”ç”¨å˜å½¢**ï¼šæ ¹æ®å…·ä½“é—®é¢˜è°ƒæ•´ç®—æ³•æ¡†æ¶

æŒæ¡Tarjanç®—æ³•åï¼Œæ‚¨å°†èƒ½å¤Ÿï¼š
- ğŸ¯ é«˜æ•ˆæ±‚è§£å¼ºè¿é€šåˆ†é‡é—®é¢˜
- ğŸ¯ å¤„ç†å¤æ‚çš„å›¾è®ºå»ºæ¨¡é—®é¢˜
- ğŸ¯ è§£å†³å·®åˆ†çº¦æŸã€2-SATç­‰é«˜çº§è¯é¢˜
- ğŸ¯ åœ¨ç«èµ›ä¸­å¿«é€Ÿè¯†åˆ«å¹¶è§£å†³ç›¸å…³é—®é¢˜

---

*âœ¨ å¸Œæœ›è¿™ä»½è¯¦ç»†çš„Tarjanç®—æ³•æ•™ç¨‹èƒ½å¤Ÿå¸®åŠ©æ‚¨æ·±å…¥ç†è§£è¿™ä¸ªå¼ºå¤§çš„å›¾è®ºç®—æ³•ï¼* 