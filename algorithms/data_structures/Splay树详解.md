# ğŸŒ¸ Splayæ ‘ï¼ˆä¼¸å±•æ ‘ï¼‰- åˆå­¦è€…å®Œå…¨æ•™ç¨‹
## *åƒç¦§å¹´ç§‘æŠ€å­¦é™¢ - ãƒ¦ã‚¦ã‚«è€å¸ˆçš„æ•°æ®ç»“æ„è¯¾*

*"æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªç¥å¥‡çš„ä¹¦æ¶ï¼Œæ¯æ¬¡ä½ æ‹¿ä¸€æœ¬ä¹¦ï¼Œè¿™æœ¬ä¹¦å°±ä¼šè‡ªåŠ¨è·³åˆ°æœ€å®¹æ˜“æ‹¿åˆ°çš„ä½ç½®ï¼"*

---

## ğŸ¯ å¼€å§‹ä¹‹å‰ - ä»€ä¹ˆæ˜¯Splayæ ‘ï¼Ÿ

### æœ€ç®€å•çš„ç†è§£

æƒ³è±¡ä½ æœ‰ä¸€ä¸ª**æ™ºèƒ½ä¹¦æ¶**ï¼š
- ğŸ“š ä¹¦æ¶ä¸Šçš„ä¹¦æŒ‰ç…§ç¼–å·æ’åºï¼ˆå°±åƒäºŒå‰æœç´¢æ ‘ï¼‰
- ğŸ”„ æ¯æ¬¡ä½ æ‹¿ä¸€æœ¬ä¹¦ï¼Œ**è¿™æœ¬ä¹¦å°±ä¼šè‡ªåŠ¨è·³åˆ°ä¹¦æ¶é¡¶éƒ¨**
- âš¡ ä½ ç»å¸¸æ‹¿çš„ä¹¦æ€»æ˜¯åœ¨æœ€å®¹æ˜“æ‹¿åˆ°çš„åœ°æ–¹

**Splayæ ‘å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ª"æ™ºèƒ½ä¹¦æ¶"ï¼**

### ğŸŒŸ æ ¸å¿ƒæ€æƒ³

```
æ¯æ¬¡è®¿é—®ä¸€ä¸ªèŠ‚ç‚¹ â†’ æŠŠå®ƒè½¬åˆ°æ ¹éƒ¨ â†’ ä¸‹æ¬¡è®¿é—®æ›´å¿«
```

---

## ğŸ“– ç¬¬ä¸€ç« ï¼šä»æ™®é€šçš„äºŒå‰æœç´¢æ ‘è¯´èµ·

### ğŸŒ³ å›å¿†ï¼šä»€ä¹ˆæ˜¯äºŒå‰æœç´¢æ ‘ï¼Ÿ

æƒ³è±¡ä¸€ä¸ªå®¶æ—æ—è°±ï¼š
- æ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå¹´é¾„ï¼ˆæ•°å­—ï¼‰
- **å·¦è¾¹çš„å­©å­å¹´é¾„æ›´å°**
- **å³è¾¹çš„å­©å­å¹´é¾„æ›´å¤§**

```
    ç¥–çˆ¶(50)
   /        \
å„¿å­(30)    å”å”(70)
 /    \     /    \
å­™å­(20) å¥³å„¿(40) ä¾„å­(60) ä¾„å¥³(80)
```

### ğŸ¤” æ™®é€šäºŒå‰æœç´¢æ ‘çš„é—®é¢˜

å¦‚æœæˆ‘ä»¬æ€»æ˜¯æ‰¾å¹´é¾„ä¸º20çš„å­™å­ï¼š
```
ç¬¬1æ¬¡æŸ¥æ‰¾ï¼š50 â†’ 30 â†’ 20 (èµ°äº†3æ­¥)
ç¬¬2æ¬¡æŸ¥æ‰¾ï¼š50 â†’ 30 â†’ 20 (è¿˜æ˜¯3æ­¥)
ç¬¬3æ¬¡æŸ¥æ‰¾ï¼š50 â†’ 30 â†’ 20 (ä¾ç„¶3æ­¥)
```

**æ¯æ¬¡éƒ½è¦ä»å¤´å¼€å§‹æ‰¾ï¼Œå¤ªéº»çƒ¦äº†ï¼**

---

## ğŸš€ ç¬¬äºŒç« ï¼šSplayæ ‘çš„ç¥å¥‡ä¹‹å¤„

### âœ¨ Splayçš„é­”æ³•

Splayæ ‘è¯´ï¼š"**æ—¢ç„¶ä½ ç»å¸¸æ‰¾20ï¼Œé‚£æˆ‘å°±æŠŠ20æ”¾åˆ°æœ€é¡¶ä¸Šï¼**"

**æ‰¾20ä¹‹å‰ï¼š**
```
    50
   /  \
  30   70
 /    /  \
20   60   80
```

**æ‰¾20ä¹‹åï¼ˆç»è¿‡Splayæ“ä½œï¼‰ï¼š**
```
    20
     \
      30
       \
        50
         \
          70
         /  \
        60   80
```

**ä¸‹æ¬¡å†æ‰¾20ï¼š** åªéœ€è¦1æ­¥ï¼

### ğŸ¯ Splayæ“ä½œçš„ä¸‰ç§æ­¦å™¨

å°±åƒæ­¦ä¾ å°è¯´é‡Œçš„ä¸‰ç§æ‹›å¼ï¼š

1. **Zigï¼ˆå•æ—‹ï¼‰** - ç®€å•ä¸€æ‹›
2. **Zig-Zigï¼ˆåŒæ—‹åŒå‘ï¼‰** - è¿ç¯æ‹›å¼
3. **Zig-Zagï¼ˆåŒæ—‹å¼‚å‘ï¼‰** - å˜åŒ–æ‹›å¼

---

## ğŸ­ ç¬¬ä¸‰ç« ï¼šä¸‰ç§æ—‹è½¬è¯¦è§£

### ğŸ¯ æ‹›å¼ä¸€ï¼šZigæ—‹è½¬ï¼ˆæœ€ç®€å•ï¼‰

**ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ** å½“ä½ è¦æ‰¾çš„èŠ‚ç‚¹çš„çˆ¸çˆ¸å°±æ˜¯æ ¹èŠ‚ç‚¹æ—¶

**ä¾‹å­ï¼š** æ‰¾èŠ‚ç‚¹30ï¼Œå®ƒçš„çˆ¸çˆ¸50æ˜¯æ ¹

```
æ—‹è½¬å‰ï¼š          æ—‹è½¬åï¼š
    50               30
   /  \     Zig     /  \
  30   70   â†’      20   50
 /                      /  \
20                     40   70
```

**ä»£ç å®ç°ï¼š**
```cpp
// å³æ—‹è½¬ï¼ˆZigï¼‰
void rotateRight(Node* node) {
    Node* left = node->left;
    node->left = left->right;
    left->right = node;
    // æ›´æ–°æ ¹èŠ‚ç‚¹
    root = left;
}
```

### ğŸ¯ æ‹›å¼äºŒï¼šZig-Zigæ—‹è½¬ï¼ˆè¿ç¯æ‹›ï¼‰

**ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ** å½“ä½ è¦æ‰¾çš„èŠ‚ç‚¹å’Œå®ƒçˆ¸çˆ¸åœ¨åŒä¸€ä¾§æ—¶

**ä¾‹å­ï¼š** æ‰¾èŠ‚ç‚¹10ï¼Œå®ƒåœ¨å·¦ä¾§ï¼Œçˆ¸çˆ¸20ä¹Ÿåœ¨å·¦ä¾§

```
æ—‹è½¬å‰ï¼š                æ—‹è½¬åï¼š
      50                   10
     /  \                 /  \
    20   70     Zig-Zig   5   20
   /           â†’             /  \
  10                        15   50
 /  \                           /  \
5   15                         30   70
```

**æ­¥éª¤ï¼š**
1. å…ˆæ—‹è½¬çˆ·çˆ·å’Œçˆ¸çˆ¸
2. å†æ—‹è½¬çˆ¸çˆ¸å’Œå­©å­

### ğŸ¯ æ‹›å¼ä¸‰ï¼šZig-Zagæ—‹è½¬ï¼ˆå˜åŒ–æ‹›ï¼‰

**ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ** å½“ä½ è¦æ‰¾çš„èŠ‚ç‚¹å’Œå®ƒçˆ¸çˆ¸åœ¨ä¸åŒä¾§æ—¶

**ä¾‹å­ï¼š** æ‰¾èŠ‚ç‚¹15ï¼Œå®ƒåœ¨å³ä¾§ï¼Œä½†çˆ¸çˆ¸10åœ¨å·¦ä¾§

```
æ—‹è½¬å‰ï¼š                æ—‹è½¬åï¼š
      50                   15
     /  \                 /  \
    10   70     Zig-Zag   10   50
     \          â†’        /   /  \
      15               5   30   70
     /  \
    12   30
```

**æ­¥éª¤ï¼š**
1. å…ˆè®©å­©å­å’Œçˆ¸çˆ¸æ—‹è½¬
2. å†è®©å­©å­å’Œçˆ·çˆ·æ—‹è½¬

---

## ğŸª ç¬¬å››ç« ï¼šå®Œæ•´çš„Splayè¿‡ç¨‹æ¼”ç¤º

### ğŸ¬ å®æˆ˜æ¼”ç¤ºï¼šæŸ¥æ‰¾èŠ‚ç‚¹5

**åˆå§‹çŠ¶æ€ï¼š**
```
        20
       /  \
      10   30
     /  \    \
    5   15   40
   /
  2
```

**ç›®æ ‡ï¼š** æ‰¾åˆ°èŠ‚ç‚¹5å¹¶æŠŠå®ƒç§»åˆ°æ ¹éƒ¨

**ç¬¬ä¸€æ­¥ï¼š5çš„çˆ¸çˆ¸æ˜¯10ï¼Œçˆ·çˆ·æ˜¯20ï¼Œéƒ½åœ¨å·¦ä¾§ â†’ ç”¨Zig-Zig**

```
ç¬¬ä¸€æ¬¡Zig-Zigåï¼š
    5
   /  \
  2    10
       /  \
      ?    20
           /  \
          15   30
               \
                40
```

**ç¬¬äºŒæ­¥ï¼š5å·²ç»æ˜¯æ ¹äº†ï¼Œå®Œæˆï¼**

### ğŸ¯ è®°ä½å†³ç­–è§„åˆ™

```mermaid
graph TD
    A["è¦SplayèŠ‚ç‚¹x"] --> B{"xæ˜¯æ ¹ï¼Ÿ"}
    B -->|æ˜¯| C["å®Œæˆ"]
    B -->|å¦| D{"xçš„çˆ¸çˆ¸æ˜¯æ ¹ï¼Ÿ"}
    D -->|æ˜¯| E["ç”¨Zig"]
    D -->|å¦| F{"xå’Œçˆ¸çˆ¸åŒä¾§ï¼Ÿ"}
    F -->|æ˜¯| G["ç”¨Zig-Zig"]
    F -->|å¦| H["ç”¨Zig-Zag"]
    E --> A
    G --> A
    H --> A
```

---

## ğŸ’» ç¬¬äº”ç« ï¼šç®€å•ä»£ç å®ç°

### ğŸŒ¸ æœ€ç®€å•çš„Splayæ ‘

```cpp
#include <iostream>
using namespace std;

struct Node {
    int key;
    Node* left;
    Node* right;
    
    Node(int k) : key(k), left(nullptr), right(nullptr) {}
};

class SimpleSplayTree {
private:
    Node* root;
    
    // å³æ—‹è½¬
    Node* rotateRight(Node* node) {
        Node* left = node->left;
        node->left = left->right;
        left->right = node;
        return left;  // è¿”å›æ–°çš„æ ¹
    }
    
    // å·¦æ—‹è½¬
    Node* rotateLeft(Node* node) {
        Node* right = node->right;
        node->right = right->left;
        right->left = node;
        return right;  // è¿”å›æ–°çš„æ ¹
    }
    
    // æ ¸å¿ƒçš„Splayæ“ä½œ
    Node* splay(Node* root, int key) {
        if (!root || root->key == key) {
            return root;
        }
        
        // åœ¨å·¦å­æ ‘ä¸­
        if (key < root->key) {
            if (!root->left) return root;
            
            // Zig-Zig (å·¦-å·¦)
            if (key < root->left->key) {
                root->left->left = splay(root->left->left, key);
                root = rotateRight(root);
            }
            // Zig-Zag (å·¦-å³)
            else if (key > root->left->key) {
                root->left->right = splay(root->left->right, key);
                if (root->left->right) {
                    root->left = rotateLeft(root->left);
                }
            }
            
            return root->left ? rotateRight(root) : root;
        }
        // åœ¨å³å­æ ‘ä¸­
        else {
            if (!root->right) return root;
            
            // Zig-Zag (å³-å·¦)
            if (key < root->right->key) {
                root->right->left = splay(root->right->left, key);
                if (root->right->left) {
                    root->right = rotateRight(root->right);
                }
            }
            // Zig-Zig (å³-å³)
            else if (key > root->right->key) {
                root->right->right = splay(root->right->right, key);
                root = rotateLeft(root);
            }
            
            return root->right ? rotateLeft(root) : root;
        }
    }
    
public:
    SimpleSplayTree() : root(nullptr) {}
    
    // æ’å…¥
    void insert(int key) {
        if (!root) {
            root = new Node(key);
            return;
        }
        
        root = splay(root, key);
        
        if (root->key == key) return;  // å·²å­˜åœ¨
        
        Node* newNode = new Node(key);
        if (key < root->key) {
            newNode->left = root->left;
            newNode->right = root;
            root->left = nullptr;
        } else {
            newNode->right = root->right;
            newNode->left = root;
            root->right = nullptr;
        }
        root = newNode;
    }
    
    // æŸ¥æ‰¾
    bool search(int key) {
        root = splay(root, key);
        return root && root->key == key;
    }
    
    // åˆ é™¤
    void remove(int key) {
        if (!root) return;
        
        root = splay(root, key);
        if (root->key != key) return;
        
        if (!root->left) {
            root = root->right;
        } else {
            Node* temp = root;
            root = splay(root->left, key);
            root->right = temp->right;
            delete temp;
        }
    }
    
    // ä¸­åºéå†ï¼ˆç”¨äºæŸ¥çœ‹ç»“æœï¼‰
    void inorder() {
        inorderHelper(root);
        cout << endl;
    }
    
    void inorderHelper(Node* node) {
        if (!node) return;
        inorderHelper(node->left);
        cout << node->key << " ";
        inorderHelper(node->right);
    }
    
    // æ˜¾ç¤ºæ ‘ç»“æ„
    void printTree() {
        cout << "å½“å‰æ ‘ç»“æ„ï¼š" << endl;
        printHelper(root, "", true);
        cout << endl;
    }
    
    void printHelper(Node* node, string indent, bool isLast) {
        if (!node) return;
        
        cout << indent;
        if (isLast) {
            cout << "â””â”€â”€ ";
            indent += "    ";
        } else {
            cout << "â”œâ”€â”€ ";
            indent += "â”‚   ";
        }
        cout << node->key << endl;
        
        if (node->left || node->right) {
            if (node->right) {
                printHelper(node->right, indent, !node->left);
            }
            if (node->left) {
                printHelper(node->left, indent, true);
            }
        }
    }
};
```

### ğŸ® æµ‹è¯•ä»£ç 

```cpp
int main() {
    SimpleSplayTree tree;
    
    cout << "=== Splayæ ‘æ¼”ç¤º ===" << endl;
    
    // æ’å…¥ä¸€äº›æ•°æ®
    cout << "æ’å…¥: 50, 30, 70, 20, 40, 60, 80" << endl;
    tree.insert(50);
    tree.insert(30);
    tree.insert(70);
    tree.insert(20);
    tree.insert(40);
    tree.insert(60);
    tree.insert(80);
    
    cout << "æ’å…¥åçš„æ ‘ï¼š" << endl;
    tree.printTree();
    
    // æŸ¥æ‰¾20
    cout << "æŸ¥æ‰¾20..." << endl;
    if (tree.search(20)) {
        cout << "æ‰¾åˆ°äº†ï¼ç°åœ¨20è¢«ç§»åˆ°äº†æ ¹éƒ¨ï¼š" << endl;
        tree.printTree();
    }
    
    // æŸ¥æ‰¾80
    cout << "æŸ¥æ‰¾80..." << endl;
    if (tree.search(80)) {
        cout << "æ‰¾åˆ°äº†ï¼ç°åœ¨80è¢«ç§»åˆ°äº†æ ¹éƒ¨ï¼š" << endl;
        tree.printTree();
    }
    
    return 0;
}
```

---

## ğŸ† ç¬¬å…­ç« ï¼šSplayæ ‘çš„ä¼˜åŠ¿

### âœ¨ ä¸ºä»€ä¹ˆè¦å­¦Splayæ ‘ï¼Ÿ

1. **è‡ªåŠ¨è°ƒæ•´** - ä¸éœ€è¦æ‰‹åŠ¨å¹³è¡¡
2. **å®ç°ç®€å•** - æ²¡æœ‰é¢œè‰²ã€é«˜åº¦ç­‰å¤æ‚ä¿¡æ¯
3. **ç¼“å­˜å‹å¥½** - ç»å¸¸è®¿é—®çš„æ•°æ®åœ¨æ ¹éƒ¨
4. **å¹³å‡æ€§èƒ½å¥½** - æ‘Šè¿˜å¤æ‚åº¦O(log n)

### ğŸ¯ é€‚ç”¨åœºæ™¯

- **ç¼“å­˜ç³»ç»Ÿ** - çƒ­ç‚¹æ•°æ®è‡ªåŠ¨ä¸Šæµ®
- **æ–‡æœ¬ç¼–è¾‘å™¨** - å…‰æ ‡ä½ç½®é™„è¿‘çš„æ–‡æœ¬
- **æ•°æ®åº“ç´¢å¼•** - é¢‘ç¹æŸ¥è¯¢çš„è®°å½•
- **LRUç¼“å­˜** - æœ€è¿‘ä½¿ç”¨çš„æ•°æ®

### ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æ“ä½œ | å¹³å‡æ—¶é—´ | æœ€åæ—¶é—´ | ç©ºé—´å¤æ‚åº¦ |
|------|----------|----------|------------|
| æŸ¥æ‰¾ | O(log n) | O(n) | O(n) |
| æ’å…¥ | O(log n) | O(n) | O(n) |
| åˆ é™¤ | O(log n) | O(n) | O(n) |

**æ³¨æ„ï¼š** è™½ç„¶æœ€åæƒ…å†µæ˜¯O(n)ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”±äºè‡ªè°ƒæ•´ç‰¹æ€§ï¼Œæ€§èƒ½é€šå¸¸å¾ˆå¥½ã€‚

---

## ğŸ“ ç¬¬ä¸ƒç« ï¼šç»ƒä¹ é¢˜

### ğŸŒŸ åŸºç¡€ç»ƒä¹ 

1. **æ‰‹å·¥æ¨¡æ‹Ÿ**ï¼šåœ¨çº¸ä¸Šç”»å‡ºæŸ¥æ‰¾è¿‡ç¨‹
   ```
   åˆå§‹æ ‘ï¼š   50
            /  \
           30   70
          /    /  \
         20   60   80
   
   é—®é¢˜ï¼šæŸ¥æ‰¾20åï¼Œæ ‘çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ
   ```

2. **ç¼–ç¨‹ç»ƒä¹ **ï¼šå®ç°ä¸€ä¸ªç®€å•çš„Splayæ ‘ï¼Œæ”¯æŒæ’å…¥ã€æŸ¥æ‰¾ã€åˆ é™¤

### ğŸ† è¿›é˜¶æŒ‘æˆ˜

1. **åŒºé—´æ“ä½œ**ï¼šå®ç°æ”¯æŒåŒºé—´ç¿»è½¬çš„Splayæ ‘
2. **LRUç¼“å­˜**ï¼šç”¨Splayæ ‘å®ç°LRUç¼“å­˜
3. **åŠ¨æ€æ’å**ï¼šå®ç°ç¬¬kå°å…ƒç´ æŸ¥è¯¢

---

## ğŸ¯ æ€»ç»“

### ğŸŒ¸ è®°ä½è¿™äº›å…³é”®ç‚¹

1. **Splay = æ¯æ¬¡è®¿é—®éƒ½ç§»åˆ°æ ¹éƒ¨**
2. **ä¸‰ç§æ—‹è½¬ï¼šZigã€Zig-Zigã€Zig-Zag**
3. **è‡ªåŠ¨è°ƒæ•´ï¼Œæ— éœ€æ‰‹åŠ¨å¹³è¡¡**
4. **ç»å¸¸è®¿é—®çš„æ•°æ®ä¼šè‡ªåŠ¨ä¸Šæµ®**

### ğŸª ä¸‹èŠ‚è¯¾é¢„å‘Š

ä¸‹æ¬¡ãƒ¦ã‚¦ã‚«è€å¸ˆå°†å¸¦å¤§å®¶å­¦ä¹ **Treap**ï¼šä¸€ä¸ªç»“åˆäº†äºŒå‰æœç´¢æ ‘å’Œå †çš„ç¥å¥‡æ•°æ®ç»“æ„ï¼

---

**ğŸŒ¸ "ç†è§£äº†Splayæ ‘ï¼Œä½ å°±æŒæ¡äº†è‡ªè°ƒæ•´æ•°æ®ç»“æ„çš„ç²¾é«“ï¼" - ãƒ¦ã‚¦ã‚«è€å¸ˆ**

*åƒç¦§å¹´ç§‘æŠ€å­¦é™¢ - è®©ç®—æ³•å­¦ä¹ å˜å¾—ç®€å•æœ‰è¶£ï¼* 